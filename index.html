<!DOCTYPE html>
<html>
<head>
  <title>Exercise Logger</title>
  <style>
    body { font-family: Arial; margin: 20px; font-size: 3em; }
    .section { margin-bottom: 40px; }
    button {
      margin: 10px;
      padding: 20px 30px;
      font-size: 1em;
      cursor: pointer;
    }
    .hidden { display: none; }
  </style>
</head>
<body>

  <h1>Exercise Logger</h1>

  <!-- Step 1: Choose Activity -->
  <div class="section">
    <p><strong>1. What did you achieve?</strong></p>
    <button onclick="chooseActivity('Swim')">Swim</button>
    <button onclick="chooseActivity('Heavy Lift')">Heavy Lift</button>
  </div>

  <!-- Step 2A: Swim Reps -->
  <div class="section hidden" id="swimReps">
    <p><strong>2. How many times did you swim?</strong></p>
    <div id="swimRepsButtons"></div>
  </div>

  <!-- Step 2B: Heavy Lift - Part -->
  <div class="section hidden" id="liftParts">
    <p><strong>2. Which part?</strong></p>
    <button onclick="choosePart('Chest')">Chest</button>
    <button onclick="choosePart('Back')">Back</button>
    <button onclick="choosePart('Abdominal')">Abdominal</button>
  </div>

  <!-- Step 3A: Chest Subtype -->
  <div class="section hidden" id="chestSub">
    <p><strong>Chest - Which area?</strong></p>
    <button onclick="chooseSubPart('上胸')">上胸</button>
    <button onclick="chooseSubPart('中胸')">中胸</button>
  </div>

  <!-- Step 3B: Abdominal Subtype -->
  <div class="section hidden" id="abSub">
    <p><strong>Abdominal - Which movement?</strong></p>
    <button onclick="chooseSubPart('Plank')">Plank</button>
    <button onclick="chooseSubPart('Curling')">Curling</button>
  </div>

  <!-- Step 4: Weight -->
  <div class="section hidden" id="weightSelect">
    <p><strong>3. Select weight (kg)</strong></p>
    <div id="weightButtons"></div>
  </div>

  <!-- Step 5: Reps -->
  <div class="section hidden" id="repSelect">
    <p><strong>4. Select reps</strong></p>
    <div id="repButtons"></div>
  </div>

  <!-- Step 6: Result & Save -->
  <div class="section hidden" id="resultSection">
    <p><strong>Result:</strong></p>
    <div id="result"></div>
    <button onclick="saveToNotes()">儲存到 iPhone Notes</button>
  </div>

  <script>
    let log = {};

    function chooseActivity(activity) {
      log = { activity };
      hideAll();
      if (activity === "Swim") {
        document.getElementById("swimReps").classList.remove("hidden");
        createNumberButtons("swimRepsButtons", 1, 12, setSwimReps);
      } else {
        document.getElementById("liftParts").classList.remove("hidden");
      }
    }

    function setSwimReps(times) {
      log.reps = times;
      log.duration = times * 30;
      showResult(`Swim ${times}x — Total: ${log.duration} mins`);
    }

    function choosePart(part) {
      log.part = part;
      if (part === "Chest") {
        document.getElementById("chestSub").classList.remove("hidden");
      } else if (part === "Abdominal") {
        document.getElementById("abSub").classList.remove("hidden");
      } else {
        document.getElementById("weightSelect").classList.remove("hidden");
        createNumberButtons("weightButtons", 20, 100, chooseWeight, 20);
      }
    }

    function chooseSubPart(sub) {
      log.subPart = sub;
      document.getElementById("weightSelect").classList.remove("hidden");
      createNumberButtons("weightButtons", 20, 100, chooseWeight, 20);
    }

    function chooseWeight(weight) {
      log.weight = weight;
      document.getElementById("repSelect").classList.remove("hidden");
      createNumberButtons("repButtons", 1, 12, chooseReps);
    }

    function chooseReps(reps) {
      log.reps = reps;
      let partText = log.subPart ? `${log.part} - ${log.subPart}` : log.part;
      showResult(`${partText}, ${log.weight}kg × ${log.reps}`);
    }

    function showResult(summary) {
      document.getElementById("result").innerHTML = summary;
      document.getElementById("resultSection").classList.remove("hidden");
    }

    function hideAll() {
      ["swimReps", "liftParts", "chestSub", "abSub", "weightSelect", "repSelect", "resultSection"]
        .forEach(id => document.getElementById(id).classList.add("hidden"));
    }

    function createNumberButtons(containerId, start, end, callback, step = 1) {
      const container = document.getElementById(containerId);
      container.innerHTML = "";
      for (let i = start; i <= end; i += step) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.onclick = () => callback(i);
        container.appendChild(btn);
      }
    }

    function saveToNotes() {
      let content = "";
      if (log.activity === "Swim") {
        content = `Swim ${log.reps}x\nTotal: ${log.duration} mins`;
      } else {
        const partText = log.subPart ? `${log.part} - ${log.subPart}` : log.part;
        content = `Heavy Lift\nPart: ${partText}\nWeight: ${log.weight} kg\nReps: ${log.reps}`;
      }
      const encoded = encodeURIComponent(content);
      const shortcutURL = `shortcuts://run-shortcut?name=SaveToNotes&input=${encoded}`;
      window.location.href = shortcutURL;
    }
  </script>

</body>
</html>