<!DOCTYPE html>
<html>
<head>
  <title>Exercise Logger</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    .section { margin-bottom: 20px; }
    button {
      margin: 5px;
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
    }
    .hidden { display: none; }
  </style>
</head>
<body>

  <h1>Exercise Logger</h1>

  <!-- Step 1: Activity -->
  <div class="section">
    <p><strong>What did you achieve?</strong></p>
    <button onclick="chooseActivity('Swim')">Swim</button>
    <button onclick="chooseActivity('Heavy Lift')">Heavy Lift</button>
  </div>

  <!-- Swim: Duration (1~12) -->
  <div class="section hidden" id="swimReps">
    <p><strong>How many times? (Swim)</strong></p>
    <div id="swimRepsButtons"></div>
  </div>

  <!-- Heavy Lift: Part -->
  <div class="section hidden" id="liftParts">
    <p><strong>Which part?</strong></p>
    <button onclick="choosePart('Chest')">Chest</button>
    <button onclick="choosePart('Back')">Back</button>
    <button onclick="choosePart('Abdominal')">Abdominal</button>
  </div>

  <!-- Heavy Lift: Weight -->
  <div class="section hidden" id="liftWeights">
    <p><strong>How many weight? (kg)</strong></p>
    <button onclick="chooseWeight(20)">20</button>
    <button onclick="chooseWeight(40)">40</button>
    <button onclick="chooseWeight(60)">60</button>
    <button onclick="chooseWeight(80)">80</button>
    <button onclick="chooseWeight(100)">100</button>
  </div>

  <!-- Heavy Lift: Reps -->
  <div class="section hidden" id="liftReps">
    <p><strong>How many reps?</strong></p>
    <div id="liftRepsButtons"></div>
  </div>

  <!-- Result + Save -->
  <div class="section" id="result"></div>
  <button class="hidden" id="saveBtn" onclick="saveToNotes()">儲存到 iPhone Notes</button>

  <script>
    let log = {};

    function createButtonGroup(containerId, callback) {
      const container = document.getElementById(containerId);
      container.innerHTML = "";
      for (let i = 1; i <= 12; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.onclick = () => callback(i);
        container.appendChild(btn);
      }
    }

    function chooseActivity(activity) {
      log = { activity };
      hideAll();
      if (activity === "Swim") {
        document.getElementById("swimReps").classList.remove("hidden");
        createButtonGroup("swimRepsButtons", setSwimReps);
      } else {
        document.getElementById("liftParts").classList.remove("hidden");
      }
    }

    function setSwimReps(times) {
      log.reps = times;
      showResult();
    }

    function choosePart(part) {
      log.part = part;
      document.getElementById("liftWeights").classList.remove("hidden");
    }

    function chooseWeight(weight) {
      log.weight = weight;
      document.getElementById("liftReps").classList.remove("hidden");
      createButtonGroup("liftRepsButtons", chooseReps);
    }

    function chooseReps(reps) {
      log.reps = reps;
      showResult();
    }

    function hideAll() {
      document.getElementById("swimReps").classList.add("hidden");
      document.getElementById("liftParts").classList.add("hidden");
      document.getElementById("liftWeights").classList.add("hidden");
      document.getElementById("liftReps").classList.add("hidden");
      document.getElementById("result").innerHTML = "";
      document.getElementById("saveBtn").classList.add("hidden");
    }

    function showResult() {
      let html = "<h3>Logged Activity:</h3><ul>";
      html += `<li>Activity: ${log.activity}</li>`;
      if (log.activity === "Swim") {
        html += `<li>Times: ${log.reps}</li>`;
      } else {
        html += `<li>Part: ${log.part}</li>`;
        html += `<li>Weight: ${log.weight} kg</li>`;
        html += `<li>Reps: ${log.reps}</li>`;
      }
      html += "</ul>";
      document.getElementById("result").innerHTML = html;
      document.getElementById("saveBtn").classList.remove("hidden");
    }

    function saveToNotes() {
      let content = `Activity Log:\nActivity: ${log.activity}`;
      if (log.activity === "Swim") {
        content += `\nTimes: ${log.reps}`;
      } else {
        content += `\nPart: ${log.part}\nWeight: ${log.weight} kg\nReps: ${log.reps}`;
      }
      const encoded = encodeURIComponent(content);
      const shortcutURL = `shortcuts://run-shortcut?name=SaveToNotes&input=${encoded}`;
      window.location.href = shortcutURL;
    }
  </script>

</body>
</html>